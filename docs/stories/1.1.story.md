# Story 1.1: 이메일/비밀번호 회원가입

## Status

**Ready for Review**

---

## Story

**As a** 신규 사용자,  
**I want** 이메일과 비밀번호로 회원가입할 수 있는 기능,  
**so that** AI 메모장 서비스를 안전하게 시작하고 내 메모를 저장할 수 있습니다.

---

## Acceptance Criteria

1. 사용자는 이메일 주소와 비밀번호를 입력하여 계정을 생성할 수 있어야 한다
2. 비밀번호는 최소 8자 이상이어야 하며, 강도 표시기가 제공되어야 한다
3. 이메일 형식이 유효하지 않거나 이미 사용 중인 경우 명확한 에러 메시지가 표시되어야 한다
4. 회원가입 성공 시 자동으로 로그인되고 메인 페이지로 이동해야 한다
5. 회원가입 폼은 모바일과 데스크톱에서 모두 직관적이고 접근성이 높아야 한다
6. 회원가입 과정은 3초 이내에 완료되어야 한다 (네트워크 정상 상태 기준)

---

## Tasks / Subtasks

- [x] Task 1: Supabase Auth 설정 및 환경 구성 (AC: 1)
  - [x] Supabase 프로젝트 설정 확인 및 Auth 활성화
  - [x] 환경 변수 설정 (NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY)
  - [x] Supabase 클라이언트 초기화 유틸리티 작성

- [x] Task 2: 회원가입 UI 컴포넌트 구현 (AC: 2, 5)
  - [x] shadcn/ui를 사용한 회원가입 폼 컴포넌트 생성
  - [x] 이메일 입력 필드 (Input 컴포넌트)
  - [x] 비밀번호 입력 필드 (Input 컴포넌트, type="password")
  - [x] 비밀번호 강도 표시기 컴포넌트 구현
  - [x] 회원가입 버튼 (Button 컴포넌트)
  - [x] Tailwind CSS로 반응형 레이아웃 스타일링
  - [x] 접근성 속성 추가 (aria-labels, form labels)

- [x] Task 3: 클라이언트 측 유효성 검사 구현 (AC: 2, 3)
  - [x] 이메일 형식 검증 (정규식 또는 라이브러리 사용)
  - [x] 비밀번호 길이 검증 (최소 8자)
  - [x] 실시간 유효성 검사 피드백 UI
  - [x] 에러 메시지 표시 로직

- [x] Task 4: 회원가입 Server Action 구현 (AC: 1, 3, 4, 6)
  - [x] `app/actions/auth.ts` 파일 생성
  - [x] `signUpWithEmail` Server Action 함수 작성
  - [x] Supabase Auth의 `signUp` 메서드 호출
  - [x] 중복 이메일 에러 핸들링
  - [x] 성공 시 자동 로그인 처리
  - [x] 에러 응답 표준화

- [x] Task 5: 회원가입 페이지 라우트 생성 (AC: 4)
  - [x] `app/signup/page.tsx` 생성
  - [x] 회원가입 컴포넌트 통합
  - [x] 성공 시 메인 페이지(`/`) 리다이렉션 로직
  - [x] 로딩 상태 UI 추가

- [x] Task 6: 에러 핸들링 및 사용자 피드백 (AC: 3)
  - [x] Toast 알림 컴포넌트 추가 (Sonner 사용)
  - [x] 서버 에러 메시지를 사용자 친화적 메시지로 변환
  - [x] 네트워크 에러 처리

- [x] Task 7: 단위 테스트 작성
  - [x] 이메일 유효성 검사 함수 테스트
  - [x] 비밀번호 강도 검사 함수 테스트
  - [x] 컴포넌트 단위 테스트

- [x] Task 8: 통합 테스트 작성
  - [x] 정상 회원가입 플로우 테스트
  - [x] 중복 이메일 에러 시나리오 테스트
  - [x] 유효하지 않은 이메일 형식 테스트

---

## Dev Notes

### 기술 스택 및 아키텍처 개요
[Source: docs/architecture.md#1-기술-스택]
- **프레임워크:** Next.js (App Router 사용)
- **UI 라이브러리:** shadcn/ui + Tailwind CSS + Radix UI
- **DB/인증:** Supabase (Auth 기능 활용)
- **호스팅:** Vercel

### 인증 구현 세부사항
[Source: docs/prd.md#6-MVP-Scope]
- 이메일 로그인만 MVP에 포함 (소셜 로그인 제외)
- Supabase Auth를 사용한 회원가입/로그인 구현

[Source: docs/architecture.md#3-보안]
- 사용자 인증은 Supabase Auth API 사용
- 권한 스코프는 서버 코드에서 처리
- Supabase 서비스 롤 키는 서버 전용 (클라이언트 노출 금지)

### 데이터 모델
[Source: docs/architecture.md#2-데이터-모델]
- Supabase Auth가 자동으로 `auth.users` 테이블 관리
- `user_id`는 향후 `notes` 테이블의 외래 키로 사용됨
- 회원가입 시점에서는 별도 커스텀 프로필 테이블 불필요 (MVP 스코프)

### 프로젝트 구조
예상 파일 구조:
```
app/
  signup/
    page.tsx              # 회원가입 페이지
  actions/
    auth.ts               # 인증 관련 Server Actions
components/
  auth/
    SignUpForm.tsx        # 회원가입 폼 컴포넌트
    PasswordStrength.tsx  # 비밀번호 강도 표시기
lib/
  supabase/
    client.ts             # Supabase 클라이언트 초기화
    server.ts             # 서버용 Supabase 클라이언트
  utils/
    validation.ts         # 유효성 검사 유틸리티
```

### UI/UX 요구사항
[Source: docs/prd.md#4-Target-Users]
- 모바일 우선 사용자 고려 → 반응형 디자인 필수
- Apple/Notion 수준의 직관적인 UX 지향 (프로젝트 규칙)
- 단순하고 깔끔하며 미니멀한 UI (프로젝트 규칙)

### 성공 지표
[Source: docs/epics/epic-1-user-authentication.md#성공-지표]
- 회원가입 완료율 85% 이상
- 인증 관련 에러율 1% 미만

### 성능 요구사항
[Source: AC 6]
- 회원가입 과정은 3초 이내 완료 (네트워크 정상 상태)

### Testing

#### 테스트 파일 위치
- 단위 테스트: `__tests__/unit/auth/` 디렉토리
- 통합 테스트: `__tests__/integration/auth/` 디렉토리
- E2E 테스트: `__tests__/e2e/auth/` 디렉토리

#### 테스트 프레임워크
- Testing frameworks 정보는 Architecture에서 명시되지 않음
- 프로젝트 규칙에 따라 `pnpm test` 명령어 사용
- Next.js 프로젝트 표준: Jest + React Testing Library 권장

#### 테스트 요구사항
- 이메일 형식 검증 로직 단위 테스트
- 비밀번호 강도 검사 로직 단위 테스트
- Server Action 모킹 및 에러 처리 테스트
- 정상 회원가입 플로우 E2E 테스트
- 중복 이메일, 잘못된 형식 등 에러 시나리오 테스트

#### 테스트 커버리지 목표
- 핵심 비즈니스 로직 100% 커버리지
- UI 컴포넌트 주요 인터랙션 테스트

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-13 | 1.0 | 스토리 초안 생성 | Bob (SM Agent) |
| 2025-10-13 | 1.1 | 스토리 구현 완료 | James (Dev Agent) |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

없음

### Completion Notes List

- 모든 기능 구현 완료
- 전체 32개 테스트 통과 (단위 테스트 25개, 통합 테스트 7개)
- Supabase Auth 통합 완료
- 비밀번호 강도 표시기 구현
- Toast 알림 (Sonner) 통합
- 반응형 디자인 및 접근성 속성 적용

### File List

#### 생성된 파일
- `.env.local` - Supabase 환경 변수
- `lib/supabase/client.ts` - 클라이언트 Supabase 클라이언트
- `lib/supabase/server.ts` - 서버 Supabase 클라이언트
- `lib/utils/validation.ts` - 유효성 검사 유틸리티
- `components/auth/PasswordStrength.tsx` - 비밀번호 강도 표시기
- `components/auth/SignUpForm.tsx` - 회원가입 폼
- `app/actions/auth.ts` - 인증 Server Actions
- `app/signup/page.tsx` - 회원가입 페이지
- `jest.config.mjs` - Jest 설정
- `jest.setup.mjs` - Jest 초기화
- `__tests__/unit/auth/validation.test.ts` - 유효성 검사 단위 테스트
- `__tests__/unit/auth/PasswordStrength.test.tsx` - 비밀번호 강도 컴포넌트 테스트
- `__tests__/unit/auth/SignUpForm.test.tsx` - 회원가입 폼 테스트
- `__tests__/integration/auth/signup.test.ts` - 회원가입 통합 테스트
- `components/ui/button.tsx` - shadcn/ui Button 컴포넌트
- `components/ui/input.tsx` - shadcn/ui Input 컴포넌트
- `components/ui/label.tsx` - shadcn/ui Label 컴포넌트
- `components/ui/card.tsx` - shadcn/ui Card 컴포넌트
- `components/ui/sonner.tsx` - Sonner Toast 컴포넌트

#### 수정된 파일
- `app/layout.tsx` - Toaster 추가, 메타데이터 업데이트
- `package.json` - 테스트 스크립트 추가, 의존성 추가

---

## QA Results

_(QA 검토 시 작성)_

